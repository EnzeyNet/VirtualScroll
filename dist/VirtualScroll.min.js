!function(a){"use strict";var b=a.module("net.enzey.virtual-scroll",[]);b.directive("nzVs",["$parse","$window","$document","$timeout",function(b,c,d,e){return{priority:9e3,compile:function(f,g){if(!a.isDefined(g.ngRepeat))throw"'nz-vs' directive requires 'ng-repeat' to be defined on the same element!";var h=/ in (.+?)(?: |$)/.exec(g.ngRepeat)[1],i="vs"+h[0].toUpperCase()+h.slice(1);g.ngRepeat=g.ngRepeat.replace(" in "+h," in "+i);var j=a.element("<"+f[0].tagName+"></"+f[0].tagName+">"),k=j.clone();f[0].parentElement.insertBefore(j[0],f[0]),f.after(k);var l,m=0,n=function(a){if(!a||a===d[0])throw"could not find a parent element with scrolling overflow!";var b=c.getComputedStyle(a);"table"===a.tagName.toLowerCase()&&"collapse"!==b.getPropertyValue("border-collapse")&&(m=2);var e=b.getPropertyValue("overflow-y");return"scroll"===e||"auto"===e?a:n(a.parentElement)},o=2,p=n(f[0].parentElement),q=function(a,b){var c=p[0].clientHeight,d=Math.floor(p[0].scrollTop/l),d=Math.max(0,d-o),e=Math.ceil(c/b)+2*o,f=d%2;d-=f,e+=f;var g=Math.min(e,a.length),h=Math.max(0,a.length-g-d),i=0;o>=h&&(i=o-h,d=Math.max(0,a.length-g-o)),k.css("height",h*l),j.css("height",d*l);for(var m=[],n=d;d+g+i>n;n++)m.push(a[n]);return m};return{pre:function(c,d){if(a.isDefined(g.nzVsBuffer)){var f=+b(g.nzVsBuffer)(c);isNaN(f)||(o=Math.max(0,f))}c.$watchCollection(h,function(a){a&&a[0]&&(l?b(i).assign(c,q(a,l)):(b(i).assign(c,[a[0]]),e(function(){var e=(d.parentElement.children[1],d.getBoundingClientRect().height);l=e+m,b(i).assign(c,q(a,l))},0,!0)))})},post:function(c){var d;a.element(p).on("scroll",function(){e.cancel(d),d=e(function(){b(i).assign(c,q(b(h)(c),l))},20)})}}}}}])}(angular);