!function(a,b){"use strict";var c=a.module("net.enzey.virtual-scroll",[]);c.directive("nzVs",["$parse","$document","$timeout",function(c,d,e){return{priority:999999,require:"ngRepeat",compile:function(f,g){var h=/ in (.+?)(?: |$)/.exec(g.ngRepeat)[1],i="vs"+h[0].toUpperCase()+h.slice(1);g.ngRepeat=g.ngRepeat.replace(" in "+h," in "+i);var j=a.element("<"+f[0].tagName+"></"+f[0].tagName+">"),k=j.clone();b(f).before(j),f.after(k);var l,m=0,n=function(a){if(!a[0]||a[0]===d[0])throw"could not find a parent element with scrolling overflow!";a=b(a),"table"===a[0].tagName.toLowerCase()&&"collapse"!==a.css("border-collapse")&&(m=2);var c=a.css("overflow-y");return"scroll"===c||"auto"===c?a:n(a.parent())},o=2,p=n(f.parent()),q=function(a,b){var c=p[0].clientHeight,d=Math.floor(p[0].scrollTop/l),d=Math.max(0,d-o),e=Math.ceil(c/b)+2*o,f=d%2;d-=f,e+=f;var g=Math.min(e,a.length),h=Math.max(0,a.length-g-d),i=0;o>=h&&(i=o-h,d=Math.max(0,a.length-g-o)),k.css("height",h*l),j.css("height",d*l);for(var m=[],n=d;d+g+i>n;n++)m.push(a[n]);return m};return{pre:function(d,f){if(a.isDefined(g.nzVsBuffer)){var j=+c(g.nzVsBuffer)(d);isNaN(j)||(o=Math.max(0,j))}d.$watchCollection(h,function(a){l?c(i).assign(d,q(a,l)):(c(i).assign(d,[a[0]]),e(function(){var e=b(f.parent().children()[1]);l=e.height()+m,c(i).assign(d,q(a,l))},0,!0))})},post:function(a){var b;p.on("scroll",function(){e.cancel(b),b=e(function(){c(i).assign(a,q(c(h)(a),l))},20)})}}}}}])}(angular,jQuery);